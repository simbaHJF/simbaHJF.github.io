---
layout:     post
title:      "Lucene简介"
date:       2019-06-17 13:30:00 +0800
author:     "simba"
header-img: "img/post-bg-miui6.jpg"
tags:
    - lucene

---


##	一.总论

根据[http://lucene.apache.org/core/index.html](http://lucene.apache.org/core/index.html)的定义:Lucene是一个搞笑的,基于Java的全文检索库.所以在了解Lucene之前先来了解一下什么是全文检索.<br>

我们常用的数据总体分成两种:结构化数据和非结构化数据.
*	结构化数据: 指具有固定格式或有限长度的数据,如数据库,元数据等.
*	非结构化数据:	指不定长或无固定格式的数据,如邮件,word文档等.
<br>

当然有的地方还有提到第三种,半结构化数据,如XML,HTML等,根据需要可按结构化数据来对其进行处理,也可抽取出纯文本按非结构化数据来处理.<br>


按照数据的分类,搜索数据页分为两种:
*	对结构化数据的搜索:如对关系型数据库的搜索,用SQL语句等
*	对非结构化数据的搜索(也就是全文检索):如利用windows的搜索可以搜索文件内容;Linux下的grep命令;Google和百度搜索大量内容数据.
<br>

对非结构化数据的搜索主要有两种方法:<br>

一种是顺序扫描法.所谓顺序扫描法,就是当要查找内容包含某一个字符串的文件,就一个文档一个文档的进行查找,对于每个文档,从头查找到尾,如果此文档包含该字符串,则此文档为我们要找的文件,接着对下一个文档进行查找,直到扫描完所有的文件.这种方法比较原始,但对于小数据量的文件,这种方式还是最直接方便的.但是对于大量的文件,这种方式会相当的慢.<br>

另一种便是全文检索技术.全文检索的基本思路是,将非结构化数据中的一部分信息提取出来,重新组织,使其变得有一定的结构,然后对此有一定结构的数据进行搜索,从而达到搜索相对较快的目的.这部分从非结构化数据中提取出的然后重新组织的信息,称之为索引.类比字典的查找过程,先通过拼音索引找到对应字的页,进而找到字相关的解释文档.<br>

这种先建立索引,再对索引进行搜索的过程就称为全文检索.下面的图来自<<Lucene in action>>,但却不仅仅描述了Lucene的检索过程,而是描述了全文检索的一般过程.
![Z3KQqP.png](https://s2.ax1x.com/2019/06/30/Z3KQqP.png)

全文检索大体分为两个过程,索引创建和搜索索引.
*	索引创建:	将现实世界中所有的结构化和非结构化数据提取信息,创建索引的过程.
*	搜索索引:	就是得到用户的查询请求,搜索创建的索引,然后返回结果的过程.
<br>

于是全文检索就存在三个重要问题:
*	索引里面存什么数据?(Index)
*	如何创建索引?(Indexing)
*	如何对索引进行搜索?(Search)
<br>

下面将对这三个问题进行进一步研究.<br>


##	二,索引里面存什么数据

顺序扫描速度慢的原因是:我们想要搜索的信息和非结构化数据中存储的信息不一致.非结构化数据中所存储的信息是每个文件包含那些字符串,即已知文件,欲求字符串相对容易,是一种从文件到字符串的映射.而我们想要搜索的信息是那些文件包含给定字符串,即已知字符串,欲求文件的过程,是一种从字符串到文件的映射.两者恰恰相反.因此,如果索引总能够保存从字符串到文件的映射,则会大大提高搜索速度.由于从字符串到文件的映射是文件到字符串映射的反向过程,于是保存这种信息的索引称为反向索引(倒排索引).<br>

反向索引所保存的信息一般如下:<br>

假设我的文档集合里面有100篇文档,为了方便表示,我们为文档从1到100进行编号,得到下面的结构:
![Z3lMrR.png](https://s2.ax1x.com/2019/06/30/Z3lMrR.png)

左边保存的是一系列字符串,称为词典.每个字符串都指向包含此字符串的文档链表,此文档链表称为倒排表.有了倒排索引,便使保存到信息和要搜索的信息一致了,可以大大加快搜索的速度.比如当需要查找既包含字符串"lucene"又包含字符串"solr"的文档,只需要以下几步:
*	取出包含字符串"lucene"的文档链表
*	取出包含字符串"solr"的文档链表
*	通过合并链表,找出既包含"lucene"又包含"solr"的文件.
<br>

过程如下图所示:
![Z3lXLR.png](https://s2.ax1x.com/2019/06/30/Z3lXLR.png)

由此可见,全文检索有一个预先建立索引的过程,如果索引的数据量很大,创建索引的过程也会相对较慢,但创建索引的过程只需要一次,以后的查询过程就只需要搜索创建好的索引就可以了.这也是全文检索相对于顺序扫描的又是之一:一次索引,多次使用.